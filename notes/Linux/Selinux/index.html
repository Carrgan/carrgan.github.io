<!doctype html>
<html lang="zh-cn" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.3">
<title data-react-helmet="true">Selinux | Carrgan Universe</title><meta data-react-helmet="true" property="og:url" content="https://carrgan.github.io/notes/Linux/Selinux"><meta data-react-helmet="true" name="docusaurus_locale" content="zh-cn"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Selinux | Carrgan Universe"><meta data-react-helmet="true" name="description" content="进程和程序"><meta data-react-helmet="true" property="og:description" content="进程和程序"><link data-react-helmet="true" rel="shortcut icon" href="/img/logo.svg"><link data-react-helmet="true" rel="canonical" href="https://carrgan.github.io/notes/Linux/Selinux"><link data-react-helmet="true" rel="alternate" href="https://carrgan.github.io/en/notes/Linux/Selinux" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://carrgan.github.io/notes/Linux/Selinux" hreflang="zh-cn"><link data-react-helmet="true" rel="alternate" href="https://carrgan.github.io/notes/Linux/Selinux" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.46332caf.css">
<link rel="preload" href="/assets/js/runtime~main.522251aa.js" as="script">
<link rel="preload" href="/assets/js/main.1f385e94.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">Carrgan Universe</b></a><a class="navbar__item navbar__link navbar__link--active" href="/notes/intro">Notes</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__item navbar__link"><span><svg viewBox="0 0 20 20" width="20" height="20" aria-hidden="true" style="vertical-align:text-bottom;margin-right:5px"><path fill="currentColor" d="M19.753 10.909c-.624-1.707-2.366-2.726-4.661-2.726-.09 0-.176.002-.262.006l-.016-2.063 3.525-.607c.115-.019.133-.119.109-.231-.023-.111-.167-.883-.188-.976-.027-.131-.102-.127-.207-.109-.104.018-3.25.461-3.25.461l-.013-2.078c-.001-.125-.069-.158-.194-.156l-1.025.016c-.105.002-.164.049-.162.148l.033 2.307s-3.061.527-3.144.543c-.084.014-.17.053-.151.143.019.09.19 1.094.208 1.172.018.08.072.129.188.107l2.924-.504.035 2.018c-1.077.281-1.801.824-2.256 1.303-.768.807-1.207 1.887-1.207 2.963 0 1.586.971 2.529 2.328 2.695 3.162.387 5.119-3.06 5.769-4.715 1.097 1.506.256 4.354-2.094 5.98-.043.029-.098.129-.033.207l.619.756c.08.096.206.059.256.023 2.51-1.73 3.661-4.515 2.869-6.683zm-7.386 3.188c-.966-.121-.944-.914-.944-1.453 0-.773.327-1.58.876-2.156a3.21 3.21 0 011.229-.799l.082 4.277a2.773 2.773 0 01-1.243.131zm2.427-.553l.046-4.109c.084-.004.166-.01.252-.01.773 0 1.494.145 1.885.361.391.217-1.023 2.713-2.183 3.758zm-8.95-7.668a.196.196 0 00-.196-.145h-1.95a.194.194 0 00-.194.144L.008 16.916c-.017.051-.011.076.062.076h1.733c.075 0 .099-.023.114-.072l1.008-3.318h3.496l1.008 3.318c.016.049.039.072.113.072h1.734c.072 0 .078-.025.062-.076-.014-.05-3.083-9.741-3.494-11.04zm-2.618 6.318l1.447-5.25 1.447 5.25H3.226z"></path></svg><span>中文（中国）</span></span></a><ul class="dropdown__menu"><li><a href="/en/notes/Linux/Selinux" target="_self" rel="noopener noreferrer" class="dropdown__link" style="text-transform:capitalize">English</a></li><li><a href="/notes/Linux/Selinux" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" style="text-transform:capitalize">中文（中国）</a></li></ul></div><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">Carrgan Universe</b></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link navbar__link--active" href="/notes/intro">Notes</a></li><li class="menu__list-item menu__list-item--collapsed"><a href="#" role="button" class="menu__link menu__link--sublist"><span><svg viewBox="0 0 20 20" width="20" height="20" aria-hidden="true" style="vertical-align:text-bottom;margin-right:5px"><path fill="currentColor" d="M19.753 10.909c-.624-1.707-2.366-2.726-4.661-2.726-.09 0-.176.002-.262.006l-.016-2.063 3.525-.607c.115-.019.133-.119.109-.231-.023-.111-.167-.883-.188-.976-.027-.131-.102-.127-.207-.109-.104.018-3.25.461-3.25.461l-.013-2.078c-.001-.125-.069-.158-.194-.156l-1.025.016c-.105.002-.164.049-.162.148l.033 2.307s-3.061.527-3.144.543c-.084.014-.17.053-.151.143.019.09.19 1.094.208 1.172.018.08.072.129.188.107l2.924-.504.035 2.018c-1.077.281-1.801.824-2.256 1.303-.768.807-1.207 1.887-1.207 2.963 0 1.586.971 2.529 2.328 2.695 3.162.387 5.119-3.06 5.769-4.715 1.097 1.506.256 4.354-2.094 5.98-.043.029-.098.129-.033.207l.619.756c.08.096.206.059.256.023 2.51-1.73 3.661-4.515 2.869-6.683zm-7.386 3.188c-.966-.121-.944-.914-.944-1.453 0-.773.327-1.58.876-2.156a3.21 3.21 0 011.229-.799l.082 4.277a2.773 2.773 0 01-1.243.131zm2.427-.553l.046-4.109c.084-.004.166-.01.252-.01.773 0 1.494.145 1.885.361.391.217-1.023 2.713-2.183 3.758zm-8.95-7.668a.196.196 0 00-.196-.145h-1.95a.194.194 0 00-.194.144L.008 16.916c-.017.051-.011.076.062.076h1.733c.075 0 .099-.023.114-.072l1.008-3.318h3.496l1.008 3.318c.016.049.039.072.113.072h1.734c.072 0 .078-.025.062-.076-.014-.05-3.083-9.741-3.494-11.04zm-2.618 6.318l1.447-5.25 1.447 5.25H3.226z"></path></svg><span>Languages</span></span></a><ul class="menu__list"><li class="menu__list-item"><a href="/en/notes/Linux/Selinux" target="_self" rel="noopener noreferrer" class="menu__link" style="text-transform:capitalize">English</a></li><li class="menu__list-item"><a href="/notes/Linux/Selinux" target="_self" rel="noopener noreferrer" class="menu__link dropdown__link--active" style="text-transform:capitalize">中文（中国）</a></li></ul></li><li class="menu__list-item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="menu__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu menu--responsive thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA" aria-label="Sidebar navigation"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/notes/intro">简介</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Python</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/Python/base">Python基础</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/Python/name-space">命名空间</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/Python/Tips-for-function">函数定义小贴士</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/Python/generator">生成器</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/Python/module">模块</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/Python/opp">OPP 宏伟蓝图</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/Python/magic-function">运算符重载</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/Python/regular">正则</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/Python/logging">何时使用Logging</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/Python/typing">类型提示</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/Python/request">request</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/Python/other">其他</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Linux</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/notes/Linux/Selinux">Selinux</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/notes/Linux/Crontab">Crontab</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/notes/Linux/SSH">SSH</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/notes/Linux/system-server">认识系统服务</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Database</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/Database/MongoDB">MongoDB</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/notes/Database/redis">Redis</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/notes/git-command">git命令速查</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="markdown"><header><h1 class="h1Heading_27L5">Selinux</h1></header><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="进程和程序"></a>进程和程序<a class="hash-link" href="#进程和程序" title="Direct link to heading">#</a></h2><blockquote><p>程序 (program):通常为 binary program ，放置在储存媒体中 (如硬盘、光盘、软盘、磁带等)， 为实体文 件的型态存在;
进程 (process):程序被触发后，执行者的权限与属性、程序的程序代码与所需数据等都会被加载内存中，操 作系统并给予这个内存内的单元一个标识符 (PID)，可以说，进程就是一个正在运作中的程序。</p></blockquote><p>常驻内存的进程就是服务=&gt;一般在末尾加d e.g hpptd
进程给予执行者权限/属性/所需脚本与数据或文件，最后给予一个PID
bash有一个PID衍生出的其他进程沿用相关权限
父进程PID对应子进程PPID号
杀死子进程父进程又会再生故先杀死父进程</p><p>Linux是多用户系统一个用户Down了可以再登陆另一个用户杀死这个用户的进程</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="工作管理"></a>工作管理<a class="hash-link" href="#工作管理" title="Direct link to heading">#</a></h2><p><strong>终端分为前景和背景</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token operator">&amp;</span><span class="token plain">           </span><span class="token comment" style="color:rgb(98, 114, 164)">#命令扔到背景去执行</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">ctrl</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">+z    </span><span class="token comment" style="color:rgb(98, 114, 164)">#命令扔到背景暂停</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">jobs</span><span class="token plain">        </span><span class="token comment" style="color:rgb(98, 114, 164)">#观察背景 -l 观察pid -r 正在运行 -s 暂停+预设的取出进程</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">fg</span><span class="token plain">          </span><span class="token comment" style="color:rgb(98, 114, 164)">#取出背景工作 fg 2 取出第二个</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">bg</span><span class="token plain"> %3       </span><span class="token comment" style="color:rgb(98, 114, 164)">#背景中第三个运作</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">stop %num   </span><span class="token comment" style="color:rgb(98, 114, 164)">#背景中暂停 红帽是 kill -stop PID</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">kill</span><span class="token plain">        </span><span class="token comment" style="color:rgb(98, 114, 164)"># -l 列出指令 -1 重读配置文件 -2 强制终止 -9 立刻删除工作 -15 正常终止 eg.kill -9 %2 killall 直接接名称</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">pstree     </span><span class="token comment" style="color:rgb(98, 114, 164)">#查看进程树 -u 后面会有所有者</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><blockquote><p>nohup 任务导向～/nohup.out 终端关闭不影响 不支持内建指令</p></blockquote><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="进程管理"></a>进程管理<a class="hash-link" href="#进程管理" title="Direct link to heading">#</a></h2><p><strong>进程的观察</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">ps</span><span class="token plain"> axjf      </span><span class="token comment" style="color:rgb(98, 114, 164)">#部分进程树状态 -o 指定部分查看 pid comm等</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">ps</span><span class="token plain"> -l       </span><span class="token comment" style="color:rgb(98, 114, 164)">#观察自己</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><blockquote><p>F 进程旗标（4:root 1子进程）<br>
S 运行状态
C cpu
PRI/NT CPU优先级
ADDR/SZ/WCHAN addr进程是内存的那一部分 - run/SZ用掉多少内存？WCHAN进程是否运行 - run
TIME 用掉CPU时间</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">ps</span><span class="token plain"> aux       </span><span class="token comment" style="color:rgb(98, 114, 164)">#观察全部</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></blockquote><blockquote><p>USER:属于那个使用者账号
PID :进程标识符
%CPU:用掉的 CPU 资源百分比;
%MEM:占用的物理内存百分比;
VSZ :使用掉的虚拟内存量 (Kbytes)
RSS :占用的固定的内存量 (Kbytes)
TTY :在那个终端机上面运作，若与终端机无关则显示 ?，另外， tty1-tty6 是本机上面的登录者进程，若为 pts/0 等等的，则表示为由网络连接进主机的进程。
STAT:该进程目前的状态，状态显示与 ps -l 的 S 旗标相同 (R/S/T/Z)
START:被触发启动的时间;
TIME :实际使用 CPU 运作的时间。
COMMAND:该进程的实际指令</p></blockquote><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">pidof </span><span class="token function" style="color:rgb(80, 250, 123)">ssh</span><span class="token plain">       </span><span class="token comment" style="color:rgb(98, 114, 164)">#查看某个进程PID</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">top</span><span class="token plain">             </span><span class="token comment" style="color:rgb(98, 114, 164)">#动态观察</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><blockquote><p>d :后面可以接秒数，整个进程画面更新的秒数。预设是 5 秒;
-b :以批次的方式执行 top，通常会搭配数据流重导向来将批次的结果输出成为文件。
-n :与 -b 搭配，意义是，需要进行几次 top 的输出结果。 -p :指定某些个 PID 来进行观察监测而已。</p></blockquote><blockquote><p>在 top 执行过程当中可以使用的按键指令:
? :显示在 top 当中可以输入的按键指令; P :以 CPU 的使用资源排序显示;
M :以 Memory 的使用资源排序显示;
N :以 PID 来排序喔!
T :由该 Process 使用的 CPU 时间累积 (TIME+) 排序。 k :给予某个 PID 一个讯号 (signal)
r :给予某个 PID 重新制订一个 nice 值。 q :离开 top 软件的按键。改变他的优先级别</p></blockquote><p><strong>TOP说明</strong></p><blockquote><p>PR :Priority 的简写，进程的优先执行顺序，越小越早被执行;
NI :Nice 的简写，与 Priority 有关，也是越小越早被执行;
%CPU:CPU 的使用率;
%MEM:内存的使用率;
TIME+:CPU 使用时间的累加;</p></blockquote><p><strong>优先级=Priority（内核决定）+nice</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">renice</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">nicenum</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">PID</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">              </span><span class="token comment" style="color:rgb(98, 114, 164)">#更改正在运行进程的优先级</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">nice</span><span class="token plain"> -n </span><span class="token number">19</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">cat</span><span class="token plain"> /dev/zero </span><span class="token operator">&gt;</span><span class="token plain"> /dev/null </span><span class="token comment" style="color:rgb(98, 114, 164)">#让运行时就以某个nice值运行</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>系统资源的观察</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">free</span><span class="token plain">        </span><span class="token comment" style="color:rgb(98, 114, 164)">#查看内存使用情况 -m mb -g gb</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">uname</span><span class="token plain">       </span><span class="token comment" style="color:rgb(98, 114, 164)">#查看系统与内核信息 </span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">uptime</span><span class="token plain">      </span><span class="token comment" style="color:rgb(98, 114, 164)">#系统启动时间工作负荷</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">netstat</span><span class="token plain">     </span><span class="token comment" style="color:rgb(98, 114, 164)">#追踪网路或插槽文件</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">netstat</span><span class="token plain"> -tulnp  </span><span class="token comment" style="color:rgb(98, 114, 164)">#查看已在监听的端口</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">vmstat</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain"> </span><span class="token number">10</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">#检测系统资源变化 一秒一次进行十次</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">demesg      </span><span class="token comment" style="color:rgb(98, 114, 164)">#分析核心产生的讯息</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><strong>特殊文件与进程</strong>
SUID</p><blockquote><p>SUID 权限仅对二进制程序(binary program)有效;
执行者对于该程序需要具有 x 的可执行权限;
本权限仅在执行该程序的过程中有效 (run-time);
执行者将具有该程序拥有者 (owner) 的权限。
<code>find / -perm /6000</code>查询所有具有s权限的可执行文件</p></blockquote><p><strong>/proc/* 代表的意义</strong></p><blockquote><p>内存当中的数据写到/proc/*目录下
目前主机各进程的PID都以目录的形式存里面 eg:systemd pid is 1 that directory is /proc/1/*</p></blockquote><p><strong>查询文件开启文件</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">fuser</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">-umv</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">-k </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">-signal</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> file/dir      </span><span class="token comment" style="color:rgb(98, 114, 164)">#藉由文件(或文件系统)找出正在使用该文件的进程</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">u :除了进程的 PID 之外，同时列出该进程的拥有者</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-m :后面接的那个档名会主动的上提到该文件系统的最顶层，对 </span><span class="token function" style="color:rgb(80, 250, 123)">umount</span><span class="token plain"> 不成功很有效</span><span class="token operator">!</span><span class="token plain"> -v :可以列出每个文件与进程还有指令的完整相关性</span><span class="token operator">!</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-k :找出使用该文件/目录的 PID ，并试图以 SIGKILL 这个讯号给予该 PID</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> -i :必须与 -k 配合，在删除 PID 之前会先询问使用者意愿</span><span class="token operator">!</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-signal:例如 -1 -15 等等，若不加的话，预设是 SIGKILL </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">-9</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><blockquote><p>ACCESS 的项目
c :此进程在当前的目录下(非次目录);
e :可被触发为执行状态;
f :是一个被开启的文件;
r :代表顶层目录 (root directory);
F :该文件被开启了，不过在等待回应中;
m :可能为分享的动态函式库;</p></blockquote><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">lsof</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">-aUu</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">+d</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">       </span><span class="token comment" style="color:rgb(98, 114, 164)">#列出被进程所开启的文件档名</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-a :多项数据需要『同时成立』才显示出结果时</span><span class="token operator">!</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-U :仅列出 Unix like 系统的 socket 文件类型</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-u :后面接 username，列出该使用者相关进程所开启的文件</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">+d :后面接目录，亦即找出某个目录底下已经被开启的文件</span><span class="token operator">!</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">pidof </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">-sx</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> program_name        </span><span class="token comment" style="color:rgb(98, 114, 164)">#找出某支正在执行的程序的 PID</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-s :仅列出一个 PID 而不列出所有的 PID</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">-x :同时列出该 program name 可能的 </span><span class="token environment constant" style="color:rgb(189, 147, 249)">PPID</span><span class="token plain"> 那个进程的 PID</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="selinux"></a>SELinux<a class="hash-link" href="#selinux" title="Direct link to heading">#</a></h2><p><strong>配置文件目录/etc/selinux/config</strong></p><blockquote><p>任何用户包括root用这个进程只能访问限制的资源
SELinux 是透过 MAC 的方式来控管进程，他控制的主体是进程， 而目标则 是该进程能否读取的『文件资源』</p></blockquote><ul><li>主体 (Subject):
SELinux 主要想要管理的就是进程，因此你可以将『主体』跟 process 划上等号;</li><li>目标 (Object):
主体进程能否存取的『目标资源』一般就是文件系统。因此这个目标项目可以等文件系统划上等号;</li><li>政策 (Policy):
由于进程与文件数量庞大，因此 SELinux 会依据某些服务来制订基本的存取安全性政策。这些政策内还会 有详细的规则 (rule) 来指定不同的服务开放某些资源的存取与否。在目前的 CentOS 7.x 里面仅有提供三个 主要的政策，分别是:<ul><li>targeted:针对网络服务限制较多，针对本机限制较少，是预设的政策;</li><li>minimum:由 target 修订而来，仅针对选择的进程来保护!</li><li>mls:完整的 SELinux 限制，限制方面较为严格。</li></ul></li><li>安全性本文 (security context):
主体与目标的安全性 本文必须一致才能够顺利存取,这个安全性本文 (security context) 有点类似文件系统的 rwx <img src="evernotecid://3665AFF6-B454-4044-8816-042E9DACA93D/appyinxiangcom/21424495/ENResource/p2" alt="2df2a02371da6b98505573a2bf31b77c.png"><blockquote><p>安全性文本放在inode里</p></blockquote></li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">ls</span><span class="token plain"> -Z           </span><span class="token comment" style="color:rgb(98, 114, 164)">#查询当前目录安全性文本</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><blockquote><p>Identify:role:type
身份识别:角色:类型</p></blockquote><ul><li>Identify<ul><li>unconfined_u:不受限的用户</li><li>system_u:系统用户</li></ul></li><li>Role<ul><li>object_r:代表的是文件或目录等文件资源</li><li>system_r:代表的就是进程啦</li></ul></li><li>Type<div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain">* type:在文件资源 (Object) 上面称为类型 (Type)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* domain:在主体进程 (Subject) 则称为领域 (domain)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><blockquote><p>Type 很重要每次
触发一个可执行文件，该文件造成的主题进程（Subject）具有crond这个领域（domain），政策（domain可读取的资料列在政策中）对这个领域制定了许多规则，crond domain被设定读取system_crond_spool_t这个类型的文件（Object），具体还看rwx
简单来说配置文件的Type必须与SELinux允许的Type相同才能读到需要读的目录</p></blockquote></li></ul><p><strong>SELinux的三种模式</strong></p><ul><li>enforcing:强制模式</li><li>permissive:宽容模式,只会警告</li><li>disabled:关闭<blockquote><p><code>getenforce</code>查看模式
<code>sestatus</code>查看政策（Policy）-v:检查/etc/sestatus.conf内的文件与进程的安全性文本 -b：列出规则（rule）
<code>setenforce [0|1] 0:permissive 1:Enforcing</code>
<strong>改变模式要重启</strong></p></blockquote></li></ul><p><strong>SELinux 的Rule</strong></p><blockquote><p><code>getsebool</code> [-a][规则名称] -a列出目前上所有selinux规则的bool
<code>seinfo [-Atrub]</code> 列出每个规则到底在限制什么</p><ul><li>-A :列出 SELinux 的状态、规则布尔值、身份识别、角色、类别等所有信息
-u :列出 SELinux 的所有身份识别 (user) 种类
-r :列出 SELinux 的所有角色 (role) 种类
-t :列出 SELinux 的所有类别 (type) 种类
-b :列出所有规则的种类 (布尔值)
<code>sesearch [-A] [-s 主体类别] [-t 目标类别] [-b 布尔值]</code> -A 列出允许读取的相关信息
<code>semanage boolean -l | grep httpd_enable_homedirs</code>看bool到底是做什么的</li></ul></blockquote><p><strong>修改SELinux的bool</strong>
<code>setsebool [-P] 『规则名称』 [0|1]</code> -P 写入配置文件</p><p><strong>SELinux安全文本的修改</strong>
<code>chcon [-R] [-t type] [-u user] [-r role] 文件</code>
<code>chcon [-R] --reference=范例文件 文件</code></p><ul><li>-R :连同该目录下的次目录也同时修改;
-t :后面接安全性本文的类型字段!例如 httpd_sys_content_t ;
-u :后面接身份识别，例如 system_u; (不重要)
-r :后面街角色，例如 system_r; (不重要)
-v :若有变化成功，请将变动的结果列出来
--reference=范例文件:拿某个文件当范例来修改后续接的文件的类型!</li></ul><p><strong>使用 restorecon 让文件恢复正确的 SELinux type</strong>
<code>restorecon [-Rv] 文件或目录</code></p><ul><li>-R :连同次目录一起修改;
-v :将过程显示到屏幕上</li></ul><p><strong>semanage 默认目录的安全性本文查询与修改</strong>
文件放在目录里会有目录的安全性文本属性
<code>semanage {login|user|port|interface|fcontext|translation} -l</code>
<code>semanage fcontext -{a|d|m} [-frst] file_spec</code></p><ul><li>fcontext :主要用在安全性本文方面的用途，
-l 为查询的意思;
-a :增加的意思，你可以增加一些目录的默认安全性本文类型设定;
-m :修改的意思; -d :删除的意思。</li></ul><p><strong>用setroubleshoot auditd来排错</strong>
SELinux 的错误讯息与克服方法记录到 /var/log/messages 与 /var/log/setroubleshoot/* 里</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/notes/Python/other"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« 其他</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/notes/Linux/Crontab"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Crontab »</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#进程和程序" class="table-of-contents__link">进程和程序</a></li><li><a href="#工作管理" class="table-of-contents__link">工作管理</a></li><li><a href="#进程管理" class="table-of-contents__link">进程管理</a></li><li><a href="#selinux" class="table-of-contents__link">SELinux</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Notes</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/notes/intro">Notes</a></li></ul></div><div class="col footer__col"><div class="footer__title">社交</div><ul class="footer__items"><li class="footer__item"><a href="https://weibo.com/u/3602696930?nick=Carrgan" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>微博<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://music.163.com/#/artist?id=12236222" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>网易云音乐<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://space.bilibili.com/72913460" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>bilibili<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">更多</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://blog.csdn.net/Carrgan?spm=1000.2115.3001.5343" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>CSDN<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2021 Carrgan Universe, Inc. Built with Docusaurus react-three/fiber.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.522251aa.js"></script>
<script src="/assets/js/main.1f385e94.js"></script>
</body>
</html>