<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper plugin-docs plugin-id-notes docs-version-current docs-doc-page docs-doc-id-database/SQL/Transaction" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.4.0">
<title data-rh="true">Transaction | Carrgan universe</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://carrgan.github.io/notes/database/SQL/Transaction"><meta data-rh="true" property="og:locale" content="zh_Hans"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-notes-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-notes-current"><meta data-rh="true" property="og:title" content="Transaction | Carrgan universe"><meta data-rh="true" name="description" content="SQL中的事务（Transaction）是指一组作为单个逻辑工作单元执行的操作。事务具有以下特性，通常简称为ACID特性："><meta data-rh="true" property="og:description" content="SQL中的事务（Transaction）是指一组作为单个逻辑工作单元执行的操作。事务具有以下特性，通常简称为ACID特性："><link data-rh="true" rel="icon" href="/img/logo.svg"><link data-rh="true" rel="canonical" href="https://carrgan.github.io/notes/database/SQL/Transaction"><link data-rh="true" rel="alternate" href="https://carrgan.github.io/notes/database/SQL/Transaction" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://carrgan.github.io/notes/database/SQL/Transaction" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Carrgan universe RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Carrgan universe Atom Feed">





<link rel="alternate" type="application/rss+xml" href="/life/rss.xml" title="Carrgan universe RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/life/atom.xml" title="Carrgan universe Atom Feed">
<link rel="alternate" type="application/rss+xml" href="/tech-blog/rss.xml" title="Carrgan universe RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/tech-blog/atom.xml" title="Carrgan universe Atom Feed">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.7cb46ea9.css">
<script src="/assets/js/runtime~main.32b8ab0c.js" defer="defer"></script>
<script src="/assets/js/main.2a90c6dc.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"dark")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Carrgan Universe</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/notes/">Notes</a><a class="navbar__item navbar__link" href="/tech-blog">Tech Blog</a><a class="navbar__item navbar__link" href="/life">Life</a><a class="navbar__item navbar__link" href="/blog">Blog</a><div class="navbar__item dropdown dropdown--hoverable"><a aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link" href="/notes/database/SQL/Transaction">Tools</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/tools/password-generator">Random password</a></li><li><a class="dropdown__link" href="/tools/text-file-split">Text file split</a></li></ul></div></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link" href="/notes/database/SQL/Transaction"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>简体中文</a><ul class="dropdown__menu"><li><a href="/notes/database/SQL/Transaction" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="zh-Hans">简体中文</a></li></ul></div><a href="https://github.com/Carrgan" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/">v3.0.0(2024.8)</a><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Sidebar navigation" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/notes/">简介</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/notes/Network/SSL-TSL">Network</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/notes/Python/base">Python</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/notes/Linux/Selinux">Linux</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/notes/linear-algebra/what">线性代数</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/notes/DotNet/ServiceLifeCycle">DotNet</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/notes/FrontEnd/micro-front-end">FrontEnd</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/notes/Java/Basic/configration-annotation">Java</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/notes/LogicPro/midi">LogicPro</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/notes/Sites/image-hosting-site">Sites</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/notes/WebRTC/">WebRTC</a><button aria-label="展开侧边栏分类 &#x27;WebRTC&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/notes/database/NoSQL/MongoDB">Database</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/notes/database/NoSQL/MongoDB">NoSQL</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/notes/database/SQL/SQL Classification">SQL</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/database/SQL/SQL Classification">SQL</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/database/SQL/View">View</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/notes/database/SQL/SQL Index">索引</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/notes/database/SQL/Transaction">Transaction</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/notes/git-command">git命令速查</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/notes/nextjs/">Next Js</a><button aria-label="展开侧边栏分类 &#x27;Next Js&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Database</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">SQL</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Transaction</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><h1>Transaction</h1>
<p>SQL中的事务（Transaction）是指一组作为单个逻辑工作单元执行的操作。事务具有以下特性，通常简称为ACID特性：</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="acid-特性详细介绍">ACID 特性详细介绍<a class="hash-link" aria-label="Direct link to heading" title="Direct link to heading" href="/notes/database/SQL/Transaction#acid-特性详细介绍">​</a></h2>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="1-原子性atomicity">1. 原子性（Atomicity）<a class="hash-link" aria-label="Direct link to heading" title="Direct link to heading" href="/notes/database/SQL/Transaction#1-原子性atomicity">​</a></h4>
<p><strong>定义</strong>：事务中的所有操作要么全部完成，要么全部不完成。即使事务失败，任何已经进行的操作都必须回滚，以确保数据库返回到事务开始之前的状态。</p>
<p><strong>实现</strong>：通过使用日志（log）或称为写前日志（Write-Ahead Logging, WAL）来实现。在事务开始之前，将要执行的操作记录到日志中。如果事务失败，系统使用这些日志来回滚未完成的操作。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="2-一致性consistency">2. 一致性（Consistency）<a class="hash-link" aria-label="Direct link to heading" title="Direct link to heading" href="/notes/database/SQL/Transaction#2-一致性consistency">​</a></h4>
<p><strong>定义</strong>：事务开始和结束时，数据库必须处于一致的状态。所有的完整性约束（如外键约束、唯一性约束等）在事务结束时必须得到满足。</p>
<p><strong>实现</strong>：数据库管理系统（DBMS）确保在每次事务开始和结束时，所有的约束和规则都得到验证和维护。例如，外键约束确保引用的记录存在，唯一性约束确保某个字段的值是唯一的。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="3-隔离性isolation">3. 隔离性（Isolation）<a class="hash-link" aria-label="Direct link to heading" title="Direct link to heading" href="/notes/database/SQL/Transaction#3-隔离性isolation">​</a></h4>
<p><strong>定义</strong>：事务的执行彼此独立，不能互相干扰。隔离性确保并发事务不会互相干扰，从而避免数据不一致的问题。</p>
<p><strong>实现</strong>：通过不同的隔离级别来管理事务之间的相互影响。常见的隔离级别包括：</p>
<ul>
<li><strong>读未提交（Read Uncommitted）</strong>：一个事务可以读取其他事务未提交的数据，可能会导致脏读（Dirty Read）。</li>
<li><strong>读已提交（Read Committed）</strong>：一个事务只能读取其他事务已提交的数据，避免脏读。</li>
<li><strong>可重复读（Repeatable Read）</strong>：一个事务在整个执行过程中，看到的数据是一致的，避免不可重复读（Non-repeatable Read）。</li>
<li><strong>串行化（Serializable）</strong>：完全隔离的级别，事务按顺序一个接一个执行，避免幻读（Phantom Read）。</li>
</ul>
<p>DBMS 使用锁（Locks）和多版本并发控制（MVCC）来实现这些隔离级别。</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>隔离级别不同导致的常见问题</summary><div><div class="collapsibleContent_i85q"><div><p>在数据库管理系统中，为了保证数据的正确性和一致性，事务的隔离级别非常重要。事务隔离级别定义了一个事务与其他事务之间的隔离程度，从而控制并发事务可能带来的问题。脏读取、不可重复读和幻读是并发事务中常见的问题。</p><ol>
<li>
<p><strong>脏读取（Dirty Read）</strong>：
脏读取是指一个事务可以读取到另一个事务尚未提交的修改。当第二个事务修改了某些数据但还未提交时，第一个事务读取了这些未提交的数据，如果第二个事务随后回滚，那么第一个事务读取到的数据就是无效的。</p>
<p>例子：</p>
<ul>
<li>事务A读取一条记录的值为100。</li>
<li>事务B将该记录的值修改为200，但尚未提交。</li>
<li>事务A再次读取该记录，得到的值为200，这是一个未提交的数据。</li>
<li>如果事务B回滚，事务A读取到的200就是脏数据。</li>
</ul>
</li>
<li>
<p><strong>不可重复读（Non-Repeatable Read）</strong>：
不可重复读是指在同一个事务中，多次读取同一条记录得到的结果不一致。这通常是因为在第一次读取和第二次读取之间，其他事务对该记录进行了修改并提交。</p>
<p>例子：</p>
<ul>
<li>事务A读取一条记录的值为100。</li>
<li>事务B将该记录的值修改为200并提交。</li>
<li>事务A再次读取该记录，得到的值为200。</li>
<li>事务A前后两次读取的结果不一致。</li>
</ul>
</li>
<li>
<p><strong>幻读（Phantom Read）</strong>：
幻读是指在同一个事务中，当执行两次相同的查询时，第二次查询的结果集中包含了第一次查询所没有的记录，或者缺少了第一次查询中存在的记录。这通常是由于其他事务在第一次查询和第二次查询之间插入或删除了记录。</p>
<p>例子：</p>
<ul>
<li>事务A查询所有满足某条件的记录，假设结果集包含10条记录。</li>
<li>事务B插入了一条满足该条件的新记录并提交。</li>
<li>事务A再次执行相同的查询，结果集包含了11条记录。</li>
<li>事务A发现多了一条“幻影”记录。</li>
</ul>
</li>
</ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="数据库事务隔离级别">数据库事务隔离级别<a class="hash-link" aria-label="Direct link to heading" title="Direct link to heading" href="/notes/database/SQL/Transaction#数据库事务隔离级别">​</a></h3><p>为了避免上述问题，SQL标准定义了四种事务隔离级别，每种级别可以防止某些类型的问题：</p><ol>
<li>
<p><strong>读未提交（Read Uncommitted）</strong>：</p>
<ul>
<li>允许脏读取。</li>
<li>允许不可重复读。</li>
<li>允许幻读。</li>
</ul>
</li>
<li>
<p><strong>读已提交（Read Committed）</strong>：</p>
<ul>
<li>不允许脏读取。</li>
<li>允许不可重复读。</li>
<li>允许幻读。</li>
</ul>
</li>
<li>
<p><strong>可重复读（Repeatable Read）</strong>：</p>
<ul>
<li>不允许脏读取。</li>
<li>不允许不可重复读。</li>
<li>允许幻读。</li>
</ul>
</li>
<li>
<p><strong>可串行化（Serializable）</strong>：</p>
<ul>
<li>不允许脏读取。</li>
<li>不允许不可重复读。</li>
<li>不允许幻读。</li>
</ul>
</li>
</ol><p>不同的数据库系统可能会在实现上有一些差异，但大多数都遵循这些隔离级别标准。选择适当的隔离级别是权衡系统性能与数据一致性的重要决策。</p></div></div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>SQL Server 中如何配置事务隔离级别</summary><div><div class="collapsibleContent_i85q"><div><p>在 SQL Server 中，可以通过设置事务隔离级别来控制事务的并发行为和数据一致性。SQL Server 提供了多种事务隔离级别，可以通过 T-SQL 语句来设置。默认的事务隔 离级别是 <strong>Read Committed</strong>（读已提交）。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="设置事务隔离级别">设置事务隔离级别<a class="hash-link" aria-label="Direct link to heading" title="Direct link to heading" href="/notes/database/SQL/Transaction#设置事务隔离级别">​</a></h3><p>可以使用 <code>SET TRANSACTION ISOLATION LEVEL</code> 语句来设置当前会话的事务隔离级别。可用的隔离级别有：</p><ol>
<li><strong>READ UNCOMMITTED</strong>（读未提交）</li>
<li><strong>READ COMMITTED</strong>（读已提交）</li>
<li><strong>REPEATABLE READ</strong>（可重复读）</li>
<li><strong>SNAPSHOT</strong>（快照隔离）</li>
<li><strong>SERIALIZABLE</strong>（可串行化）</li>
</ol><p>以下是一些示例：</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="读未提交read-uncommitted">读未提交（READ UNCOMMITTED）<a class="hash-link" aria-label="Direct link to heading" title="Direct link to heading" href="/notes/database/SQL/Transaction#读未提交read-uncommitted">​</a></h4><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token keyword" style="color:rgb(127, 219, 202)">SET</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">TRANSACTION</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">ISOLATION</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">LEVEL</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">READ</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">UNCOMMITTED</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="偷走" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="读已提交read-committed">读已提交（READ COMMITTED）<a class="hash-link" aria-label="Direct link to heading" title="Direct link to heading" href="/notes/database/SQL/Transaction#读已提交read-committed">​</a></h4><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token keyword" style="color:rgb(127, 219, 202)">SET</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">TRANSACTION</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">ISOLATION</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">LEVEL</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">READ</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">COMMITTED</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="偷走" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="可重复读repeatable-read">可重复读（REPEATABLE READ）<a class="hash-link" aria-label="Direct link to heading" title="Direct link to heading" href="/notes/database/SQL/Transaction#可重复读repeatable-read">​</a></h4><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token keyword" style="color:rgb(127, 219, 202)">SET</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">TRANSACTION</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">ISOLATION</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">LEVEL</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">REPEATABLE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">READ</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="偷走" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="快照隔离snapshot">快照隔离（SNAPSHOT）<a class="hash-link" aria-label="Direct link to heading" title="Direct link to heading" href="/notes/database/SQL/Transaction#快照隔离snapshot">​</a></h4><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token keyword" style="color:rgb(127, 219, 202)">SET</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">TRANSACTION</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">ISOLATION</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">LEVEL</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">SNAPSHOT</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="偷走" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="可串行化serializable">可串行化（SERIALIZABLE）<a class="hash-link" aria-label="Direct link to heading" title="Direct link to heading" href="/notes/database/SQL/Transaction#可串行化serializable">​</a></h4><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token keyword" style="color:rgb(127, 219, 202)">SET</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">TRANSACTION</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">ISOLATION</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">LEVEL</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">SERIALIZABLE</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="偷走" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="示例">示例<a class="hash-link" aria-label="Direct link to heading" title="Direct link to heading" href="/notes/database/SQL/Transaction#示例">​</a></h3><p>以下是一个完整的示例，展示如何设置事务隔离级别并执行查询：</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">-- 设置事务隔离级别为可重复读</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">SET</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">TRANSACTION</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">ISOLATION</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">LEVEL</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">REPEATABLE</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">READ</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">BEGIN</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">TRANSACTION</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">-- 执行查询</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">SELECT</span><span class="token plain"> </span><span class="token operator" style="color:rgb(127, 219, 202)">*</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">FROM</span><span class="token plain"> MyTable</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">-- 提交事务</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">COMMIT</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="偷走" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="默认事务隔离级别">默认事务隔离级别<a class="hash-link" aria-label="Direct link to heading" title="Direct link to heading" href="/notes/database/SQL/Transaction#默认事务隔离级别">​</a></h3><p>SQL Server 默认的事务隔离级别是 <strong>Read Committed</strong>。这意味着一个事务只能读取到其他事务已经提交的数据，从而避免了脏读取问题。要检查当前的隔离级别，可以使用以下查询：</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token keyword" style="color:rgb(127, 219, 202)">DBCC</span><span class="token plain"> USEROPTIONS</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="偷走" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>此命令将显示当前会话的各种设置，包括事务隔离级别。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="快照隔离级别的配置">快照隔离级别的配置<a class="hash-link" aria-label="Direct link to heading" title="Direct link to heading" href="/notes/database/SQL/Transaction#快照隔离级别的配置">​</a></h3><p>使用快照隔离级别需要在数据库级别启用快照隔离和读已提交快照隔离。可以使用以下命令：</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token keyword" style="color:rgb(127, 219, 202)">ALTER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">DATABASE</span><span class="token plain"> YourDatabaseName</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">SET</span><span class="token plain"> ALLOW_SNAPSHOT_ISOLATION </span><span class="token keyword" style="color:rgb(127, 219, 202)">ON</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">ALTER</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">DATABASE</span><span class="token plain"> YourDatabaseName</span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">SET</span><span class="token plain"> READ_COMMITTED_SNAPSHOT </span><span class="token keyword" style="color:rgb(127, 219, 202)">ON</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="偷走" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div></details>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="4-持久性durability">4. 持久性（Durability）<a class="hash-link" aria-label="Direct link to heading" title="Direct link to heading" href="/notes/database/SQL/Transaction#4-持久性durability">​</a></h4>
<p><strong>定义</strong>：一旦事务提交，对数据库的改变是永久性的，即使系统故障也不会丢失这些改变。</p>
<p><strong>实现</strong>：DBMS 使用持久存储（如硬盘）和日志文件来确保事务的持久性。事务提交前，所有的变更会记录在日志文件中，即使系统崩溃，通过这些日志文件可以恢复数据。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="事务执行过程">事务执行过程<a class="hash-link" aria-label="Direct link to heading" title="Direct link to heading" href="/notes/database/SQL/Transaction#事务执行过程">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-数据变更过程">1. 数据变更过程<a class="hash-link" aria-label="Direct link to heading" title="Direct link to heading" href="/notes/database/SQL/Transaction#1-数据变更过程">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="内存中的数据缓冲区">内存中的数据缓冲区<a class="hash-link" aria-label="Direct link to heading" title="Direct link to heading" href="/notes/database/SQL/Transaction#内存中的数据缓冲区">​</a></h4>
<ul>
<li>当事务执行数据变更操作（如INSERT、UPDATE或DELETE）时，这些变更首先会应用到数据库的内存缓冲区（Buffer Pool）中。这个缓冲区中存储了数据页的副本，实际的数据页在磁盘上。</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="日志记录">日志记录<a class="hash-link" aria-label="Direct link to heading" title="Direct link to heading" href="/notes/database/SQL/Transaction#日志记录">​</a></h4>
<ul>
<li>在将数据页写入磁盘之前，数据库会先将这些变更记录到事务日志（Transaction Log）中。这一过程被称为写前日志（Write-Ahead Logging, WAL）。日志记录在内存中的日志缓冲区，并在适当的时间点刷新到磁盘。</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-提交前的变更状态">2. 提交前的变更状态<a class="hash-link" aria-label="Direct link to heading" title="Direct link to heading" href="/notes/database/SQL/Transaction#2-提交前的变更状态">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="隔离性">隔离性<a class="hash-link" aria-label="Direct link to heading" title="Direct link to heading" href="/notes/database/SQL/Transaction#隔离性">​</a></h4>
<ul>
<li>在事务提交之前，这些变更是不可见的。<em>(一般情况下，数据库默认的隔离等级为 Read Committed)</em> 其他事务在查询数据库时，看到的仍然是提交之前的数据状态。这是通过锁和多版本并发控制（MVCC）来实现的。</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="暂存变更">暂存变更<a class="hash-link" aria-label="Direct link to heading" title="Direct link to heading" href="/notes/database/SQL/Transaction#暂存变更">​</a></h4>
<ul>
<li>数据变更暂时存储在内存的缓冲区中，只有在事务提交时  ，才会将这些变更永久地写入磁盘上的数据文件。</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-事务提交过程">3. 事务提交过程<a class="hash-link" aria-label="Direct link to heading" title="Direct link to heading" href="/notes/database/SQL/Transaction#3-事务提交过程">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="刷新日志">刷新日志<a class="hash-link" aria-label="Direct link to heading" title="Direct link to heading" href="/notes/database/SQL/Transaction#刷新日志">​</a></h4>
<ul>
<li>在提交事务时，首先将内存中的日志缓冲区内容刷新到磁盘，确保所有的变更操作都持久化在日志文件中。</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="写入数据">写入数据<a class="hash-link" aria-label="Direct link to heading" title="Direct link to heading" href="/notes/database/SQL/Transaction#写入数据">​</a></h4>
<ul>
<li>在日志持久化后，将内存缓冲区中的数据页写入磁盘上的实际数据文件。这个过程确保了数据的持久性。</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-事务回滚">4. 事务回滚<a class="hash-link" aria-label="Direct link to heading" title="Direct link to heading" href="/notes/database/SQL/Transaction#4-事务回滚">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="回滚操作">回滚操作<a class="hash-link" aria-label="Direct link to heading" title="Direct link to heading" href="/notes/database/SQL/Transaction#回滚操作">​</a></h4>
<ul>
<li>如果事务在提交前失败或被回滚，DBMS会使用Undo Log中的记录撤销已经执行的变更操作，确保数据库恢复到事务开始前的一致状态。</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="事务的底层实现">事务的底层实现<a class="hash-link" aria-label="Direct link to heading" title="Direct link to heading" href="/notes/database/SQL/Transaction#事务的底层实现">​</a></h2>
<ol>
<li>
<p><strong>日志管理</strong></p>
<ul>
<li><strong>WAL（Write-Ahead Logging）</strong>：在事务提交前，将所有的变更写入日志文件。这些日志记录了事务的开始、每一步的变更以及事务的提交或回滚。</li>
<li><strong>Redo Log</strong>：在系统崩溃后，通过Redo Log重新应用已提交的事务，以确保数据的一致性。</li>
<li><strong>Undo Log</strong>：在事务失败后，通过Undo Log回滚未完成的事务，以确保数据的原子性。</li>
</ul>
</li>
<li>
<p><strong>锁机制</strong></p>
<ul>
<li><strong>排它锁（Exclusive Lock）</strong>：用于写操作，确保其他事务不能读或写被锁定的资源。</li>
<li><strong>共享锁（Shared Lock）</strong>：用于读操作，允许其他事务读，但不允许写。</li>
<li><strong>意向锁（Intent Lock）</strong>：用于表级锁，以表明将要在表的某些行上获取锁。</li>
</ul>
</li>
<li>
<p><strong>多版本并发控制（MVCC）</strong></p>
<ul>
<li><strong>MVCC</strong>：为每个事务创建数据的多个版本，以实现高并发性。每个事务只能看到在其开始之前提交的版本，从而实现可重复读。</li>
</ul>
</li>
<li>
<p><strong>恢复机制</strong></p>
<ul>
<li><strong>检查点（Checkpoint）</strong>：定期将内存中的数据写入磁盘，并记录当前状态，减少崩溃后恢复所需的时间。</li>
<li><strong>崩溃恢复</strong>：在系统重启时，利用日志文件和检查点信息，重新应用未完成的事务，回滚失败的事务，确保数据库的一致性和持久性。
在事务提交前，数据的变更实际上是暂时存储在内存中的，并且这些变更对其他事务不可见。这种暂时存储的机制主要是为了确保事务的原子性、一致性和隔离性。以下是详细的过程：</li>
</ul>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="示例-1">示例<a class="hash-link" aria-label="Direct link to heading" title="Direct link to heading" href="/notes/database/SQL/Transaction#示例-1">​</a></h2>
<p>假设有一个简单的事务更新银行账户余额：</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token keyword" style="color:rgb(127, 219, 202)">BEGIN</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">TRANSACTION</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">-- 从账户A中减去100元</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">UPDATE</span><span class="token plain"> Accounts </span><span class="token keyword" style="color:rgb(127, 219, 202)">SET</span><span class="token plain"> balance </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> balance </span><span class="token operator" style="color:rgb(127, 219, 202)">-</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">100</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">WHERE</span><span class="token plain"> account_id </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;A&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">-- 向账户B中加上100元</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">UPDATE</span><span class="token plain"> Accounts </span><span class="token keyword" style="color:rgb(127, 219, 202)">SET</span><span class="token plain"> balance </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> balance </span><span class="token operator" style="color:rgb(127, 219, 202)">+</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">100</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">WHERE</span><span class="token plain"> account_id </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;B&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">-- 提交事务</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">COMMIT</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="偷走" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="过程解释">过程解释<a class="hash-link" aria-label="Direct link to heading" title="Direct link to heading" href="/notes/database/SQL/Transaction#过程解释">​</a></h3>
<ol>
<li>
<p><strong>数据变更应用到内存缓冲区</strong>：</p>
<ul>
<li><code>UPDATE Accounts SET balance = balance - 100 WHERE account_id = &#x27;A&#x27;;</code></li>
<li><code>UPDATE Accounts SET balance = balance + 100 WHERE account_id = &#x27;B&#x27;;</code></li>
<li>这些操作在内存的缓冲区中进行，并记录在日志缓冲区中。</li>
</ul>
</li>
<li>
<p><strong>日志写入磁盘</strong>：</p>
<ul>
<li>在事务提交时，将日志缓冲区的内容写入磁盘，确保所有变更操作都有日志记录。</li>
</ul>
</li>
<li>
<p><strong>数据页写入磁盘</strong>：</p>
<ul>
<li>将内存缓冲区中的数据页写入磁盘上的实际数据文件。</li>
</ul>
</li>
<li>
<p><strong>提交完成</strong>：</p>
<ul>
<li>提交事务，其他事务现在可以看到这些变更。</li>
</ul>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="回滚操作示例">回滚操作示例<a class="hash-link" aria-label="Direct link to heading" title="Direct link to heading" href="/notes/database/SQL/Transaction#回滚操作示例">​</a></h3>
<p>如果在 事务提交前发生错误或手动回滚：</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token keyword" style="color:rgb(127, 219, 202)">BEGIN</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">TRANSACTION</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">-- 从账户A中减去100元</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">UPDATE</span><span class="token plain"> Accounts </span><span class="token keyword" style="color:rgb(127, 219, 202)">SET</span><span class="token plain"> balance </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> balance </span><span class="token operator" style="color:rgb(127, 219, 202)">-</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">100</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">WHERE</span><span class="token plain"> account_id </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;A&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">-- 向账户B中加上100元</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">UPDATE</span><span class="token plain"> Accounts </span><span class="token keyword" style="color:rgb(127, 219, 202)">SET</span><span class="token plain"> balance </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> balance </span><span class="token operator" style="color:rgb(127, 219, 202)">+</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">100</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">WHERE</span><span class="token plain"> account_id </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;B&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">-- 出现错误，回滚事务</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">ROLLBACK</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="偷走" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="过程解释-1">过程解释<a class="hash-link" aria-label="Direct link to heading" title="Direct link to heading" href="/notes/database/SQL/Transaction#过程解释-1">​</a></h4>
<ol>
<li>
<p><strong>数据变更应用到内存缓冲区</strong>：</p>
<ul>
<li>与上面的过程相同。</li>
</ul>
</li>
<li>
<p><strong>回滚操作</strong>：</p>
<ul>
<li>使用Undo Log中的记录，将账户A的余额加回100元，将账户B的余额减去100元，恢复到事务开始前的状态。</li>
</ul>
</li>
</ol>
<p>通过这种机制，DBMS可以确保在事务提交前的数据变更是暂时的，并在事务提交后才永久生效，从而保证数据的一致性和持久性。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="事务的原子性和一致性经常被混淆">事务的原子性和一致性经常被混淆<a class="hash-link" aria-label="Direct link to heading" title="Direct link to heading" href="/notes/database/SQL/Transaction#事务的原子性和一致性经常被混淆">​</a></h4>
<ul>
<li>原子性：强调事务要么全部成功，要么全部失败</li>
<li>一致性：强调事物开始前结束后，数据库状态和数据的一致（有时可能需要人为去保证）</li>
</ul>
<p>假设我们有一个学生表Students和一个成绩表Grades，学生ID必须存在于学生表中才能插入到成绩表</p>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#d6deeb;--prism-background-color:#011627"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#d6deeb;background-color:#011627"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#d6deeb"><span class="token keyword" style="color:rgb(127, 219, 202)">BEGIN</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">TRANSACTION</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">-- 检查学生ID是否存在</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">SELECT</span><span class="token plain"> student_id </span><span class="token keyword" style="color:rgb(127, 219, 202)">FROM</span><span class="token plain"> Students </span><span class="token keyword" style="color:rgb(127, 219, 202)">WHERE</span><span class="token plain"> student_id </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;S1&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">-- 如果学生ID存在，插入成绩</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">IF</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">EXISTS</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style="color:rgb(127, 219, 202)">SELECT</span><span class="token plain"> student_id </span><span class="token keyword" style="color:rgb(127, 219, 202)">FROM</span><span class="token plain"> Students </span><span class="token keyword" style="color:rgb(127, 219, 202)">WHERE</span><span class="token plain"> student_id </span><span class="token operator" style="color:rgb(127, 219, 202)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;S1&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">THEN</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token keyword" style="color:rgb(127, 219, 202)">INSERT</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">INTO</span><span class="token plain"> Grades </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">student_id</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> grade</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">VALUES</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;S1&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(173, 219, 103)">&#x27;A&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">ELSE</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token comment" style="color:rgb(99, 119, 119);font-style:italic">-- 抛出异常或错误，学生ID不存在</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain">    </span><span class="token keyword" style="color:rgb(127, 219, 202)">ROLLBACK</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">END</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(127, 219, 202)">IF</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#d6deeb"><span class="token plain"></span><span class="token keyword" style="color:rgb(127, 219, 202)">COMMIT</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="偷走" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>在这个例子中，一致性要求学生成绩的插入必须确保相关的学生ID在学生表中存在。如果学生ID不存在，事务会回滚，以保证数据的完整性。</p>
<p>这些例子展示了一致性在不同情景下的应用，强调了事务执行前后的数据规则和约束必须得到满足，从而确保数据库的有效状态。</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/notes/database/SQL/SQL Index"><div class="pagination-nav__sublabel">看看前面的</div><div class="pagination-nav__label">索引</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/notes/git-command"><div class="pagination-nav__sublabel">接着看</div><div class="pagination-nav__label">git命令速查</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a class="table-of-contents__link toc-highlight" href="/notes/database/SQL/Transaction#acid-特性详细介绍">ACID 特性详细介绍</a><ul><li><a class="table-of-contents__link toc-highlight" href="/notes/database/SQL/Transaction#数据库事务隔离级别">数据库事务隔离级别</a></li><li><a class="table-of-contents__link toc-highlight" href="/notes/database/SQL/Transaction#设置事务隔离级别">设置事务隔离级别</a></li><li><a class="table-of-contents__link toc-highlight" href="/notes/database/SQL/Transaction#示例">示例</a></li><li><a class="table-of-contents__link toc-highlight" href="/notes/database/SQL/Transaction#默认事务隔离级别">默认事务隔离级别</a></li><li><a class="table-of-contents__link toc-highlight" href="/notes/database/SQL/Transaction#快照隔离级别的配置">快照隔离级别的配置</a></li></ul></li><li><a class="table-of-contents__link toc-highlight" href="/notes/database/SQL/Transaction#事务执行过程">事务执行过程</a><ul><li><a class="table-of-contents__link toc-highlight" href="/notes/database/SQL/Transaction#1-数据变更过程">1. 数据变更过程</a></li><li><a class="table-of-contents__link toc-highlight" href="/notes/database/SQL/Transaction#2-提交前的变更状态">2. 提交前的变更状态</a></li><li><a class="table-of-contents__link toc-highlight" href="/notes/database/SQL/Transaction#3-事务提交过程">3. 事务提交过程</a></li><li><a class="table-of-contents__link toc-highlight" href="/notes/database/SQL/Transaction#4-事务回滚">4. 事务回滚</a></li></ul></li><li><a class="table-of-contents__link toc-highlight" href="/notes/database/SQL/Transaction#事务的底层实现">事务的底层实现</a></li><li><a class="table-of-contents__link toc-highlight" href="/notes/database/SQL/Transaction#示例-1">示例</a><ul><li><a class="table-of-contents__link toc-highlight" href="/notes/database/SQL/Transaction#过程解释">过程解释</a></li><li><a class="table-of-contents__link toc-highlight" href="/notes/database/SQL/Transaction#回滚操作示例">回滚操作示例</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Notes</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/Notes/">Notes</a></li><li class="footer__item"><a class="footer__link-item" href="/notes/Network/SSL-TSL">SSL/TSL</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://weibo.com/u/3602696930?nick=Carrgan" target="_blank" rel="noopener noreferrer" class="footer__link-item">Weibo<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://music.163.com/#/artist?id=12236222" target="_blank" rel="noopener noreferrer" class="footer__link-item">NetEase Music<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://space.bilibili.com/72913460" target="_blank" rel="noopener noreferrer" class="footer__link-item">Bilibili<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Useful site</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://roadmap.sh" target="_blank" rel="noopener noreferrer" class="footer__link-item">Tech roadmap<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Tech Blog</a></li><li class="footer__item"><a class="footer__link-item" href="/life">Life</a></li><li class="footer__item"><a href="https://github.com/Carrgan" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://blog.csdn.net/Carrgan" target="_blank" rel="noopener noreferrer" class="footer__link-item">CSDN<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://docusaurus.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Docusaurus<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://react-spring.dev/" target="_blank" rel="noopener noreferrer" class="footer__link-item">React-Spring<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><img src="/img/logo-with-text.svg" alt="Carrgan Universe Logo" class="footer__logo themedComponent_mlkZ themedComponent--light_NVdE" width="160" height="51"><img src="/img/logo-with-text.svg" alt="Carrgan Universe Logo" class="footer__logo themedComponent_mlkZ themedComponent--dark_xIcU" width="160" height="51"></div><div class="footer__copyright">Copyright © 2024 Carrgan. All Rights Reserved</div></div></div></footer></div>
</body>
</html>